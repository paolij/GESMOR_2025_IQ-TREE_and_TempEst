# UF 2025 GSEMOR Workshop
# IQ-TREE and TempEST Tutorial
# Julia Paoli

## Background



### IQ-TREE Analysis


1. **Set up your folders in HPG**

Navigate to the workshop folder in the blue server. Go into your personal folder using the cd command. Make a new folder called IQ-TREE

```bash
cd /blue/general_workshop/<your folder>
```

```bash
mkdir IQ-TREE
```

2. **Let's write a script for running IQ-TREE**
```bash
nano iqtree.sh
```

```bash
#!/bin/bash
#SBATCH --job-name=IQ-TREE
#SBATCH --mem=20G
#SBATCH --time=24:00:00
#SBATCH --nodes=1
#SBATCH --cpus-per-task=1
#SBATCH --account=general_workshop
#SBATCH --qos=general_workshop
#SBATCH --mail-user=<username>@ufl.edu
#SBATCH --mail-type=ALL

module load iq-tree/2.2.2.7

## Usage
# sbatch iqtree.sh <path_to_fasta_file>

## Script

# Input Fasta File
FASTA=$1

# Extract the base name of the FASTA file without path and extension
BASE_NAME=$(basename "$FASTA" | sed 's/\..*//')

# Run IQ-TREE
iqtree -s "${FASTA}" \
    -m MFP \
    -bb 1000 \
    -nt AUTO \
    -lmap 20000
```

3. **Run your IQ-TREE script**
```bash
sbatch iqtree.sh /blue/general_workshop/share/iqtree/TBEV_with_outgroup.fasta
```

4. **Download your output files**

You should now download all of the output files generated by IQ-Tree. Save these to a folder for future reference. 

5. **Visualize your ML Tree in FigTree**

We can visualize our ML tree using software like FigTree. You should have downloaded FigTree for the workshop. If not, the download link is [here](https://github.com/rambaut/figtree/releases).

Open the TBEV_with_outgroup.treefile. This should automatically open in FigTree. If not, right click on the file to select FigTree. 

When you first open the file in FigTree, you should see an unrooted tree. FigTree allows user to do midpoint rooting or to outgroup root by user selection. 

In this tutoraial, we have just inferred a phylogenetic tree with Orthoflavivirus Omsk hemorrhagic fever virus (OHFV) included as an outgroup (AY193805.1). In fig tree find the tip labelled AY193805.1 and select Reroot in the top left corner. Now you have an outgroup rooted tree!

To show tips in ascending order, in the left panel select Trees &rarr; order nodes.

To show the ultrafast branch labels, in the left panel select Branch Labels &rarr; Display label.

